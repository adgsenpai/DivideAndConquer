# Q4. Euclid's GCD (variable-size decrease)

## (a) Correctness of the recurrence gcd(m, n) = gcd(n, m mod n)

**Claim:** gcd(m, n) = gcd(n, m mod n) for m ≥ n > 0

**Proof using divisibility properties:**

Let d = gcd(m, n) and r = m mod n, so m = qn + r where q = ⌊m/n⌋ and 0 ≤ r < n.

**Step 1:** Show that gcd(m, n) divides gcd(n, r)
- Since d = gcd(m, n), we have d | m and d | n
- From m = qn + r, we get r = m - qn
- Since d | m and d | n, we have d | (m - qn), thus d | r
- Therefore d is a common divisor of n and r
- Hence d ≤ gcd(n, r)

**Step 2:** Show that gcd(n, r) divides gcd(m, n)
- Let d' = gcd(n, r), so d' | n and d' | r
- From m = qn + r, since d' | n and d' | r, we have d' | (qn + r), thus d' | m
- Therefore d' is a common divisor of m and n
- Hence d' ≤ gcd(m, n) = d

**Conclusion:**
- From Steps 1 and 2: d ≤ gcd(n, r) and gcd(n, r) ≤ d
- Therefore gcd(m, n) = gcd(n, r) = gcd(n, m mod n) ✓

**Base case:** gcd(m, 0) = m (any number divides 0, so gcd is m itself)

---

## (b) Running time is O(log min{m, n})

**Fibonacci Connection:**

**Lemma (Lamé's Theorem):** If Euclid's algorithm takes k steps on inputs (m, n) with m ≥ n, then n ≥ F_{k+1}, where F_i is the i-th Fibonacci number.

**Proof sketch:**
Let the remainder sequence be: m = r₀, n = r₁, r₂, r₃, ..., r_k, 0

Key observation: r_i ≥ r_{i+1} + r_{i+2} for all i

This is because:
- r_i = q_{i+1} · r_{i+1} + r_{i+2}
- Since q_{i+1} ≥ 1, we have r_i ≥ r_{i+1} + r_{i+2}

Working backwards from r_k = 1:
- r_k ≥ 1 = F₂
- r_{k-1} ≥ 1 = F₃  
- r_{k-2} ≥ r_{k-1} + r_k ≥ F₃ + F₂ = F₄
- r_{k-3} ≥ r_{k-2} + r_{k-1} ≥ F₄ + F₃ = F₅
- ...
- r₁ = n ≥ F_{k+1}

**Time Complexity:**
Since n ≥ F_{k+1} and F_k ≈ φ^k/√5 (where φ = (1+√5)/2 ≈ 1.618), we have:
- n ≥ φ^{k+1}/√5
- k + 1 ≤ log_φ(n√5)
- k = O(log n)

Therefore, the number of iterations is **O(log min{m, n})**.

**Tighter bound:** k ≤ ⌊log_φ(√5 · min{m,n})⌋ ≈ 1.44 · log₂(min{m,n})

---

## Example trace

For gcd(105, 252):
- gcd(252, 105) → 252 = 2 × 105 + 42
- gcd(105, 42) → 105 = 2 × 42 + 21
- gcd(42, 21) → 42 = 2 × 21 + 0
- gcd(21, 0) = 21

Steps: 3, and indeed 42 ≥ F₄ = 3, 105 ≥ F₅ = 5, 252 ≥ F₆ = 8 ✓
